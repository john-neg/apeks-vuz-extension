{% extends 'base.html' %}
{% block content %}

<h1 class="display-6">
  {% block title %} {{ title }} {% endblock %}
</h1>
<p>в рабочие программы дисциплин учебного плана:</p>

<div class="d-grid col-xl-8">
  <div class="h4 mt-2 mb-4 text-white text-center bg-dark fw-normal">
    <b>{{ plan_name }}</b>
  </div>
</div>

<form action="" enctype="multipart/form-data" method="post">
  {{ form.hidden_tag() }}

  <div class="row">
    <div class="d-grid col-xl-4">
      <input type="submit" name="library_load_temp" value="Шаблон" class="btn btn-warning bg-opacity-75">
    </div>
    <div class="d-grid col-xl-4">
      <input type="submit" name="library_plan_content" value="{{ lib_type_name }} в РПД плана" class="btn btn-primary bg-opacity-75">
    </div>
  </div>
  <div class="row mb-4 gy-3">
    <div class="d-grid col-xl-4 text-center text-wrap">
      (Скачать образец заполнения файла для загрузки)
    </div>
    <div class="d-grid col-xl-4 text-center text-wrap">
      (Таблица с данными из рабочих программ плана)
    </div>
  </div>

  <div class="row mb-3 gy-3">
    <div class="col-xl-8">
      <label for="formFile" class="form-label">Выберите файл Excel для загрузки</label>
      <input class="form-control" type="file" name="file" id="formFile">
    </div>
  </div>
  <div class="row mb-3 gy-3">
    <div class="d-grid col-xl-8">
      <input type="submit" name="library_check" value="Проверка данных" class="btn btn-secondary">
    </div>
  </div>

  {% if no_data %}
    <div>
      <table class="col-md-7 mt-3 table">
        <tr class="table-danger">
          <td>В загруженном файле нет данных для дисциплин:</td>
        </tr>
        {% for disc in no_data %}
          <tr>
            <td><span style="white-space: pre-line"><b>{{ disc }}</b></span></td>
          </tr>
        {% endfor %}
      </table>
    </div>
  {% endif %}

  {% if no_program %}
    <div>
      <table class="col-md-7 mt-3 table">
        <tr class="table-warning">
            <td>В плане отсутствуют рабочие программы:</td>
        </tr>
          {% for disc in no_program %}
            <tr>
              <td><span style="white-space: pre-line"><b>{{ no_program[disc] }}</b></span></td>
            </tr>
          {% endfor %}
      </table>
    </div>
  {% endif %}

  {% if duplicate %}
    <div>
      <table class="col-md-7 mt-3 table">
        <tr class="table-warning">
            <td>В плане существуют дубликаты программ:</td>
        </tr>
          {% for disc in duplicate %}
            <tr>
              <td><span style="white-space: pre-line"><b>{{ duplicate[disc] }}</b></span></td>
            </tr>
          {% endfor %}
      </table>
    </div>
  {% endif %}

  {% if wrong_name %}
    <div>
      <table class="col-md-7 mt-3 table">
        <tr class="table-danger">
            <td>Название рабочей программы не соответствует названию дисциплины:</td>
        </tr>
          {% for disc in wrong_name %}
            <tr>
              <td><span style="white-space: pre-line"><b>План - "{{ wrong_name[disc][0] }}"</b></span></td>
            </tr>
            <tr>
              <td><span style="white-space: pre-line"><b>Программа - "{{ wrong_name[disc][1] }}"</b></span></td>
            </tr>
          {% endfor %}
      </table>
    </div>
  {% endif %}

  {% if work_programs %}
    <div>
      <table class="col-md-7 mt-3 table">
        <tr class="table-success">
          <td>Будет(ут) загружена(ы) <b>{{ lib_type_name }}</b> для следующих программ:</td>
        </tr>
          {% for prog in work_programs %}
            <tr>
              <td><span style="white-space: pre-line"><b>{{ prog }}</b></span></td>
            </tr>
          {% endfor %}
      </table>
    </div>
  {% endif %}

  <div class="row mb-3 gy-3">
    <div class="d-grid col-xl-8">
      <input type="submit" name="library_update" value="Загрузить данные" class="btn btn-success">
    </div>
  </div>
</form>
{% endblock %}